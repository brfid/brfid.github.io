; VAX 11/780 with 4.3BSD — pexpect mode
;
; Console is stdin/stdout (no telnet). No network. No terminal multiplexer.
; Disk images must be decompressed to RA81.000 / RA81VHD.001 before use.
; SIMH working directory must be /image so relative disk paths resolve.
;
; For use with the vax-pexpect Docker image (Dockerfile.vax-pexpect).

set cpu idle=QUASIJARUS
set cpu 64m
set prompt "vaxbsd>> "
set tti 7b
set tto 7b

; DZ-11 terminal multiplexer — disabled (no telnet terminals needed)
set dz disabled

; DHU-11, Card Reader — disabled
set vh disabled
set cr disabled

; Line printer
set lpt enabled
attach lpt printer.txt

; RP (Massbus) disks — not attached (BSD uses RA81 MSCP disks)
set rp enabled
set rp0 RP06
set rp1 RP06
set rp2 RP06
set rp3 RP06

; RL removable diskpacks — not attached
set rl enabled
set rl0 RL02
set rl1 RL02

; Disable other small hard disks
set hk disabled
set rk disabled

; MSCP Disks (RA81 — gunzipped at Docker build time from RA81.000.gz)
set rq enabled
set rq0 ra81
att rq0 RA81.000
set rq1 format=vhd
set rq1 ra81
att rq1 RA81VHD.001
set rq2 RA81
set rq3 RA81

set ry disabled
set tu disabled

; Tape
set ts enabled

; Network — disabled (not needed for artifact pipeline)
set xu disabled
set tq disabled
set dmc disabled

; Boot program
; R10=9 (RA device major), R11=0 (autoboot)
load -o boot43 0
d r10 9
d r11 0

echo ================================================================
echo = VAX 4.3BSD pexpect mode — console is stdin/stdout            =
echo = Root has no password. No telnet ports.                       =
echo ================================================================

; Boot
run 2

; SIMH exits when BSD halts (normal pipeline end-of-run behaviour).
quit
