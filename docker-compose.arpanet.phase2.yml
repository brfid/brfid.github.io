# ARPANET Build Integration - Phase2
# Generated from arpanet/topology/definitions.py - DO NOT EDIT MANUALLY
# To regenerate: arpanet-topology phase2
#
# Topology: [VAX/BSD] <-> [IMP #1] <-> [IMP #2] <-> [PDP-10/ITS]

version: '3.8'
services:
  vax:
    container_name: arpanet-vax
    hostname: vax-host
    image: jguillaumes/simh-vaxbsd@sha256:1bab805b25a793fd622c29d3e9b677b002cabbdc20d9c42afaeeed542cc42215
    ports:
    - 2323:2323
    volumes:
    - ./build/vax/simh-tape:/machines
    - ./arpanet/scripts/simh-automation:/machines/automation:ro
    networks:
      arpanet:
        ipv4_address: 172.20.0.10
    environment:
    - SIMH_NETWORK=enabled
    restart: unless-stopped
  imp1:
    container_name: arpanet-imp1
    hostname: imp-1
    build:
      context: ./arpanet
      dockerfile: Dockerfile.imp
    ports:
    - 2324:2323
    volumes:
    - ./build/arpanet/imp1:/machines/data
    - ./arpanet/configs/imp1-phase2.ini:/machines/imp.ini:ro
    - ./arpanet/configs/impcode.simh:/machines/impcode.simh:ro
    - ./arpanet/configs/impconfig.simh:/machines/impconfig.simh:ro
    networks:
      arpanet:
        ipv4_address: 172.20.0.20
    restart: unless-stopped
    depends_on:
    - vax
  imp2:
    container_name: arpanet-imp2
    hostname: imp-2
    build:
      context: ./arpanet
      dockerfile: Dockerfile.imp
    ports:
    - 2325:2323
    volumes:
    - ./build/arpanet/imp2:/machines/data
    - ./arpanet/configs/imp2.ini:/machines/imp.ini:ro
    - ./arpanet/configs/impcode.simh:/machines/impcode.simh:ro
    - ./arpanet/configs/impconfig.simh:/machines/impconfig.simh:ro
    networks:
      arpanet:
        ipv4_address: 172.20.0.30
    restart: unless-stopped
    depends_on:
    - imp1
    - pdp10
  pdp10:
    container_name: arpanet-pdp10
    hostname: pdp10-host
    build:
      context: ./arpanet
      dockerfile: Dockerfile.pdp10-its
    ports:
    - 2326:2323
    - 10004:10004
    volumes:
    - ./build/arpanet/pdp10:/machines/data
    - ./arpanet/configs/phase2/pdp10.ini:/machines/pdp10.ini:ro
    networks:
      arpanet:
        ipv4_address: 172.20.0.40
    environment:
    - ITS_FORCE_RESEED=0
    restart: unless-stopped
networks:
  arpanet:
    name: arpanet-build
    driver: bridge
    ipam:
      config:
      - subnet: 172.20.0.0/16
        gateway: 172.20.0.1
